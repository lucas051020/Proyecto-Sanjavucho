{% extends "tienda/base.html" %}

{% block title %}Catálogo Sanjavucho{% endblock %}

{% block content %}

{% if not categoria %}
<div class="bg-dark text-white p-5 mb-5 rounded text-center"
    style="background-image: linear-gradient(to right, #434343 0%, black 100%);">
    <h1 class="display-4 fw-bold">Bienvenido a Sanjavucho</h1>
    <p class="lead">Encuentra lo mejor en tecnología y videojuegos al mejor precio.</p>
    <hr class="my-4 bg-light">
    <p>Envíos a todo el país. Precios especiales por mayor.</p>
</div>
{% endif %}

<div class="container">
    <div class="row">

        <div class="col-lg-3 mb-4">
            <div class="list-group shadow-sm">
                <a href="{% url 'tienda_app:lista_productos' %}"
                    class="list-group-item list-group-item-action {% if not categoria %}active fw-bold{% endif %}">
                    Todas las Categorías
                </a>
                {% for c in categorias %}
                <a href="{% url 'tienda_app:lista_productos_por_categoria' c.slug %}"
                    class="list-group-item list-group-item-action {% if categoria.slug == c.slug %}active fw-bold{% endif %}">
                    {{ c.nombre }}
                </a>
                {% endfor %}
            </div>
        </div>

        <div class="col-lg-9">

            {% if categoria %}
            <h2 class="mb-4 border-bottom pb-2">{{ categoria.nombre }}</h2>
            {% else %}
            <h2 class="mb-4 border-bottom pb-2">Destacados</h2>
            {% endif %}

            <div class="row row-cols-1 row-cols-md-3 g-4">
                {% for producto in productos %}
                <div class="col">
                    <div class="card h-100 shadow-sm">
                        <a href="{% url 'tienda_app:detalle_producto' producto.id producto.slug %}">
                            {% if producto.imagen %}
                            <img src="{{ producto.imagen.url }}" class="card-img-top" alt="{{ producto.nombre }}"
                                style="height: 250px; object-fit: contain; background-color: #fff;">
                            {% else %}
                            <img src="https://via.placeholder.com/250x250.png?text=Sin+Imagen" class="card-img-top"
                                alt="Sin imagen">
                            {% endif %}
                        </a>

                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title text-truncate">
                                <a href="{% url 'tienda_app:detalle_producto' producto.id producto.slug %}"
                                    class="text-dark text-decoration-none">
                                    {{ producto.nombre }}
                                </a>
                            </h5>
                            <p class="card-text text-success fw-bold fs-5">${{ producto.precio }}</p>

                            <div class="mt-auto d-grid">
                                <a href="{% url 'tienda_app:detalle_producto' producto.id producto.slug %}"
                                    class="btn btn-outline-primary">
                                    Ver Detalle
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="col-12 text-center py-5">
                    <h3 class="text-muted">No se encontraron productos.</h3>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}